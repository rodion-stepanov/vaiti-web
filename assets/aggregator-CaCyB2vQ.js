import{j as e,F as y,o as m,B as o,u as C,r as w,q as k}from"./index-BkLrirJi.js";import{S}from"./search-filters-CnTTPSS-.js";import{C as x,a as u,b as p,c as $,d as h,e as j}from"./card-D0tTWIEy.js";import{L as c}from"./label-BL5qDNPi.js";import{I as F}from"./input-NBdPHJ0v.js";function T({className:s,...t}){return e.jsx("textarea",{"data-slot":"textarea",className:y("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),...t})}const E=()=>{const{filters:s,setFilters:t,filteredCount:r,isFiltering:l,isApplying:a,error:n,applySuccessMessage:i,fetchFilteredVacancies:f,applyToVacancies:g}=m(),d=N=>{const{name:b,value:v}=N.target;t({[b]:v})};return e.jsxs(x,{children:[e.jsxs(u,{children:[e.jsx(p,{children:"Автоотклик"}),e.jsx($,{children:"Настройте и запустите автоматическую отправку откликов на подходящие вакансии."})]}),e.jsxs(h,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"coverLetter",children:"Сопроводительное письмо"}),e.jsx(T,{id:"coverLetter",name:"coverLetter",value:s.coverLetter||"",onChange:d,placeholder:"Напишите здесь ваше сопроводительное письмо...",rows:5})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"keywordsToExclude",children:"Исключить вакансии со словами"}),e.jsx(F,{id:"keywordsToExclude",name:"keywordsToExclude",value:s.keywordsToExclude||"",onChange:d,placeholder:"Например: стажер, ассистент, курьер"}),e.jsx("p",{className:"text-muted-foreground text-xs",children:"Перечислите слова через запятую."})]})]}),e.jsxs(j,{className:"flex flex-col items-stretch space-y-4",children:[i&&e.jsx("p",{className:"text-center text-sm font-semibold text-green-600",children:i}),n&&e.jsx("p",{className:"text-destructive text-center text-sm font-semibold",children:n}),e.jsx(o,{onClick:f,disabled:l||a,children:l?"Проверяем...":"Проверить кол-во подходящих вакансий"}),r!==null&&!i&&e.jsxs("div",{className:"text-center text-sm",children:[e.jsxs("p",{className:"mb-2",children:["Найдено ",e.jsx("span",{className:"font-bold",children:r})," новых вакансий для отклика."]}),r>0&&e.jsx(o,{onClick:g,disabled:a||r===0,className:"w-full",children:a?"Отправляем...":`Откликнуться на ${r} вакансий`})]})]})]})},L=s=>{if(!s)return"З/п не указана";const{from:t,to:r,currency:l}=s;return t&&r?`${t} - ${r} ${l}`:t?`от ${t} ${l}`:r?`до ${r} ${l}`:"З/п не указана"},_=({vacancy:s})=>e.jsxs(x,{className:"mb-4 w-full",children:[e.jsx(u,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-grow",children:[e.jsx("a",{href:s.alternate_url,target:"_blank",rel:"noopener noreferrer",children:e.jsx(p,{className:"text-lg hover:underline",children:s.name})}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:s.employer.name})]}),s.employer.logo_urls?.["90"]&&e.jsx("img",{src:s.employer.logo_urls[90],alt:`${s.employer.name} logo`,className:"ml-4 w-12 rounded-md"})]})}),e.jsxs(h,{children:[e.jsx("p",{className:"mb-2 text-base font-semibold",children:L(s.salary_range)}),e.jsx("p",{className:"text-muted-foreground mb-4 text-sm",children:s.area.name}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{className:"font-medium",children:"Требования:"})," ",s.snippet.requirement]}),e.jsxs("p",{children:[e.jsx("strong",{className:"font-medium",children:"Обязанности:"})," ",s.snippet.responsibility]})]})]}),e.jsx(j,{className:"flex justify-end",children:e.jsx(o,{children:"Откликнуться"})})]}),R=()=>{const{vacancies:s,isLoading:t,error:r,fetchResumes:l}=m(),{accessToken:a}=C();return w.useEffect(()=>{a&&l()},[a,l]),e.jsxs("div",{className:"grid gap-8 md:grid-cols-3",children:[e.jsxs("div",{className:"flex flex-col gap-8 md:col-span-1",children:[e.jsx(S,{}),e.jsx(E,{})]}),e.jsx("div",{className:"space-y-4 md:col-span-2",children:t?[...Array(3)].map((n,i)=>e.jsx(k,{className:"h-48 w-full"},i)):r?e.jsx("p",{className:"text-destructive",children:r}):s.length>0?s.map(n=>e.jsx(_,{vacancy:n},n.id)):e.jsx("p",{className:"text-muted-foreground p-4 text-center",children:"Вакансии не найдены. Попробуйте изменить фильтры."})})]})};export{R as component};
